!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a.JSEncrypt={})}(this,function(a){"use strict";function b(a){return E.charAt(a)}function c(a,b){return a&b}function d(a,b){return a|b}function e(a,b){return a^b}function f(a,b){return a&~b}function g(a){if(0==a)return-1;var b=0;return 0==(65535&a)&&(a>>=16,b+=16),0==(255&a)&&(a>>=8,b+=8),0==(15&a)&&(a>>=4,b+=4),0==(3&a)&&(a>>=2,b+=2),0==(1&a)&&++b,b}function h(a){for(var b=0;0!=a;)a&=a-1,++b;return b}function i(a){var b,c,d="";for(b=0;b+3<=a.length;b+=3)c=parseInt(a.substring(b,b+3),16),d+=F.charAt(c>>6)+F.charAt(63&c);for(b+1==a.length?(c=parseInt(a.substring(b,b+1),16),d+=F.charAt(c<<2)):b+2==a.length&&(c=parseInt(a.substring(b,b+2),16),d+=F.charAt(c>>2)+F.charAt((3&c)<<4));(3&d.length)>0;)d+=G;return d}function j(a){var c,d="",e=0,f=0;for(c=0;c<a.length&&a.charAt(c)!=G;++c){var g=F.indexOf(a.charAt(c));g<0||(0==e?(d+=b(g>>2),f=3&g,e=1):1==e?(d+=b(f<<2|g>>4),f=15&g,e=2):2==e?(d+=b(f),d+=b(g>>2),f=3&g,e=3):(d+=b(f<<2|g>>4),d+=b(15&g),e=0))}return 1==e&&(d+=b(f<<2)),d}function k(a,b){function c(){this.constructor=a}H(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}function l(a,b){return a.length>b&&(a=a.substring(0,b)+M),a}function m(){return new W(null)}function n(a,b){return new W(a,b)}function o(a,b,c,d,e,f){for(;--f>=0;){var g=b*this[a++]+c[d]+e;e=Math.floor(g/67108864),c[d++]=67108863&g}return e}function p(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this[a],j=this[a++]>>15,k=h*i+j*g;i=g*i+((32767&k)<<15)+c[d]+(1073741823&e),e=(i>>>30)+(k>>>15)+h*j+(e>>>30),c[d++]=1073741823&i}return e}function q(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this[a],j=this[a++]>>14,k=h*i+j*g;i=g*i+((16383&k)<<14)+c[d]+e,e=(i>>28)+(k>>14)+h*j,c[d++]=268435455&i}return e}function r(a,b){var c=ca[a.charCodeAt(b)];return null==c?-1:c}function s(a){var b=m();return b.fromInt(a),b}function t(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function u(){return new fa}function v(){if(null==da){for(da=u();ea<ga;){var a=Math.floor(65536*Math.random());ha[ea++]=255&a}for(da.init(ha),ea=0;ea<ha.length;++ea)ha[ea]=0;ea=0}return da.next()}function w(a,b){if(b<a.length+22)return console.error("Message too long for RSA"),null;for(var c=b-a.length-6,d="",e=0;e<c;e+=2)d+="ff";return n("0001"+d+"00"+a,16)}function x(a,b){if(b<a.length+11)return console.error("Message too long for RSA"),null;for(var c=[],d=a.length-1;d>=0&&b>0;){var e=a.charCodeAt(d--);e<128?c[--b]=e:e>127&&e<2048?(c[--b]=63&e|128,c[--b]=e>>6|192):(c[--b]=63&e|128,c[--b]=e>>6&63|128,c[--b]=e>>12|224)}c[--b]=0;for(var f=new la,g=[];b>2;){for(g[0]=0;0==g[0];)f.nextBytes(g);c[--b]=g[0]}return c[--b]=2,c[--b]=0,new W(c)}function y(a,b){for(var c=a.toByteArray(),d=0;d<c.length&&0==c[d];)++d;if(c.length-d!=b-1||2!=c[d])return null;for(++d;0!=c[d];)if(++d>=c.length)return null;for(var e="";++d<c.length;){var f=255&c[d];f<128?e+=String.fromCharCode(f):f>191&&f<224?(e+=String.fromCharCode((31&f)<<6|63&c[d+1]),++d):(e+=String.fromCharCode((15&f)<<12|(63&c[d+1])<<6|63&c[d+2]),d+=2)}return e}function z(a){return na[a]||""}function A(a){for(var b in na)if(na.hasOwnProperty(b)){var c=na[b],d=c.length;if(a.substr(0,d)==c)return a.substr(d)}return a}var B,C,D,E="0123456789abcdefghijklmnopqrstuvwxyz",F="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",G="=",H=function(a,b){return(H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},I={decode:function(a){var b;if(void 0===B){var c="0123456789ABCDEF",d=" \f\n\r\t \u2028\u2029";for(B={},b=0;b<16;++b)B[c.charAt(b)]=b;for(c=c.toLowerCase(),b=10;b<16;++b)B[c.charAt(b)]=b;for(b=0;b<d.length;++b)B[d.charAt(b)]=-1}var e=[],f=0,g=0;for(b=0;b<a.length;++b){var h=a.charAt(b);if("="==h)break;if(-1!=(h=B[h])){if(void 0===h)throw new Error("Illegal character at offset "+b);f|=h,++g>=2?(e[e.length]=f,f=0,g=0):f<<=4}}if(g)throw new Error("Hex encoding incomplete: 4 bits missing");return e}},J={decode:function(a){var b;if(void 0===C){var c="= \f\n\r\t \u2028\u2029";for(C=Object.create(null),b=0;b<64;++b)C["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(b)]=b;for(b=0;b<c.length;++b)C[c.charAt(b)]=-1}var d=[],e=0,f=0;for(b=0;b<a.length;++b){var g=a.charAt(b);if("="==g)break;if(-1!=(g=C[g])){if(void 0===g)throw new Error("Illegal character at offset "+b);e|=g,++f>=4?(d[d.length]=e>>16,d[d.length]=e>>8&255,d[d.length]=255&e,e=0,f=0):e<<=6}}switch(f){case 1:throw new Error("Base64 encoding incomplete: at least 2 bits missing");case 2:d[d.length]=e>>10;break;case 3:d[d.length]=e>>16,d[d.length]=e>>8&255}return d},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor:function(a){var b=J.re.exec(a);if(b)if(b[1])a=b[1];else{if(!b[2])throw new Error("RegExp out of sync");a=b[2]}return J.decode(a)}},K=1e13,L=function(){function a(a){this.buf=[+a||0]}return a.prototype.mulAdd=function(a,b){var c,d,e=this.buf,f=e.length;for(c=0;c<f;++c)d=e[c]*a+b,d<K?b=0:(b=0|d/K,d-=b*K),e[c]=d;b>0&&(e[c]=b)},a.prototype.sub=function(a){var b,c,d=this.buf,e=d.length;for(b=0;b<e;++b)c=d[b]-a,c<0?(c+=K,a=1):a=0,d[b]=c;for(;0===d[d.length-1];)d.pop()},a.prototype.toString=function(a){if(10!=(a||10))throw new Error("only base 10 is supported");for(var b=this.buf,c=b[b.length-1].toString(),d=b.length-2;d>=0;--d)c+=(K+b[d]).toString().substring(1);return c},a.prototype.valueOf=function(){for(var a=this.buf,b=0,c=a.length-1;c>=0;--c)b=b*K+a[c];return b},a.prototype.simplify=function(){var a=this.buf;return 1==a.length?a[0]:this},a}(),M="…",N=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,O=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,P=function(){function a(b,c){this.hexDigits="0123456789ABCDEF",b instanceof a?(this.enc=b.enc,this.pos=b.pos):(this.enc=b,this.pos=c)}return a.prototype.get=function(a){if(void 0===a&&(a=this.pos++),a>=this.enc.length)throw new Error("Requesting byte offset "+a+" on a stream of length "+this.enc.length);return"string"==typeof this.enc?this.enc.charCodeAt(a):this.enc[a]},a.prototype.hexByte=function(a){return this.hexDigits.charAt(a>>4&15)+this.hexDigits.charAt(15&a)},a.prototype.hexDump=function(a,b,c){for(var d="",e=a;e<b;++e)if(d+=this.hexByte(this.get(e)),!0!==c)switch(15&e){case 7:d+="  ";break;case 15:d+="\n";break;default:d+=" "}return d},a.prototype.isASCII=function(a,b){for(var c=a;c<b;++c){var d=this.get(c);if(d<32||d>176)return!1}return!0},a.prototype.parseStringISO=function(a,b){for(var c="",d=a;d<b;++d)c+=String.fromCharCode(this.get(d));return c},a.prototype.parseStringUTF=function(a,b){for(var c="",d=a;d<b;){var e=this.get(d++);c+=e<128?String.fromCharCode(e):e>191&&e<224?String.fromCharCode((31&e)<<6|63&this.get(d++)):String.fromCharCode((15&e)<<12|(63&this.get(d++))<<6|63&this.get(d++))}return c},a.prototype.parseStringBMP=function(a,b){for(var c,d,e="",f=a;f<b;)c=this.get(f++),d=this.get(f++),e+=String.fromCharCode(c<<8|d);return e},a.prototype.parseTime=function(a,b,c){var d=this.parseStringISO(a,b),e=(c?N:O).exec(d);return e?(c&&(e[1]=+e[1],e[1]+=+e[1]<70?2e3:1900),d=e[1]+"-"+e[2]+"-"+e[3]+" "+e[4],e[5]&&(d+=":"+e[5],e[6]&&(d+=":"+e[6],e[7]&&(d+="."+e[7]))),e[8]&&(d+=" UTC","Z"!=e[8]&&(d+=e[8],e[9]&&(d+=":"+e[9]))),d):"Unrecognized time: "+d},a.prototype.parseInteger=function(a,b){for(var c,d=this.get(a),e=d>127,f=e?255:0,g="";d==f&&++a<b;)d=this.get(a);if(0===(c=b-a))return e?-1:0;if(c>4){for(g=d,c<<=3;0==(128&(+g^f));)g=+g<<1,--c;g="("+c+" bit)\n"}e&&(d-=256);for(var h=new L(d),i=a+1;i<b;++i)h.mulAdd(256,this.get(i));return g+h.toString()},a.prototype.parseBitString=function(a,b,c){for(var d=this.get(a),e=(b-a-1<<3)-d,f="("+e+" bit)\n",g="",h=a+1;h<b;++h){for(var i=this.get(h),j=h==b-1?d:0,k=7;k>=j;--k)g+=i>>k&1?"1":"0";if(g.length>c)return f+l(g,c)}return f+g},a.prototype.parseOctetString=function(a,b,c){if(this.isASCII(a,b))return l(this.parseStringISO(a,b),c);var d=b-a,e="("+d+" byte)\n";c/=2,d>c&&(b=a+c);for(var f=a;f<b;++f)e+=this.hexByte(this.get(f));return d>c&&(e+=M),e},a.prototype.parseOID=function(a,b,c){for(var d="",e=new L,f=0,g=a;g<b;++g){var h=this.get(g);if(e.mulAdd(128,127&h),f+=7,!(128&h)){if(""===d)if((e=e.simplify())instanceof L)e.sub(80),d="2."+e.toString();else{var i=e<80?e<40?0:1:2;d=i+"."+(e-40*i)}else d+="."+e.toString();if(d.length>c)return l(d,c);e=new L,f=0}}return f>0&&(d+=".incomplete"),d},a}(),Q=function(){function a(a,b,c,d,e){if(!(d instanceof R))throw new Error("Invalid tag value.");this.stream=a,this.header=b,this.length=c,this.tag=d,this.sub=e}return a.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}},a.prototype.content=function(a){if(void 0===this.tag)return null;void 0===a&&(a=1/0);var b=this.posContent(),c=Math.abs(this.length);if(!this.tag.isUniversal())return null!==this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(b,b+c,a);switch(this.tag.tagNumber){case 1:return 0===this.stream.get(b)?"false":"true";case 2:return this.stream.parseInteger(b,b+c);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(b,b+c,a);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(b,b+c,a);case 6:return this.stream.parseOID(b,b+c,a);case 16:case 17:return null!==this.sub?"("+this.sub.length+" elem)":"(no elem)";case 12:return l(this.stream.parseStringUTF(b,b+c),a);case 18:case 19:case 20:case 21:case 22:case 26:return l(this.stream.parseStringISO(b,b+c),a);case 30:return l(this.stream.parseStringBMP(b,b+c),a);case 23:case 24:return this.stream.parseTime(b,b+c,23==this.tag.tagNumber)}return null},a.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},a.prototype.toPrettyString=function(a){void 0===a&&(a="");var b=a+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(b+="+"),b+=this.length,this.tag.tagConstructed?b+=" (constructed)":!this.tag.isUniversal()||3!=this.tag.tagNumber&&4!=this.tag.tagNumber||null===this.sub||(b+=" (encapsulates)"),b+="\n",null!==this.sub){a+="  ";for(var c=0,d=this.sub.length;c<d;++c)b+=this.sub[c].toPrettyString(a)}return b},a.prototype.posStart=function(){return this.stream.pos},a.prototype.posContent=function(){return this.stream.pos+this.header},a.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},a.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},a.decodeLength=function(a){var b=a.get(),c=127&b;if(c==b)return c;if(c>6)throw new Error("Length over 48 bits not supported at position "+(a.pos-1));if(0===c)return null;b=0;for(var d=0;d<c;++d)b=256*b+a.get();return b},a.prototype.getHexStringValue=function(){var a=this.toHexString(),b=2*this.header,c=2*this.length;return a.substr(b,c)},a.decode=function(b){var c;c=b instanceof P?b:new P(b,0);var d=new P(c),e=new R(c),f=a.decodeLength(c),g=c.pos,h=g-d.pos,i=null,j=function(){var b=[];if(null!==f){for(var d=g+f;c.pos<d;)b[b.length]=a.decode(c);if(c.pos!=d)throw new Error("Content size is not correct for container starting at offset "+g)}else try{for(;;){var e=a.decode(c);if(e.tag.isEOC())break;b[b.length]=e}f=g-c.pos}catch(a){throw new Error("Exception while decoding undefined length content: "+a)}return b};if(e.tagConstructed)i=j();else if(e.isUniversal()&&(3==e.tagNumber||4==e.tagNumber))try{if(3==e.tagNumber&&0!=c.get())throw new Error("BIT STRINGs with unused bits cannot encapsulate.");i=j();for(var k=0;k<i.length;++k)if(i[k].tag.isEOC())throw new Error("EOC is not supposed to be actual content.")}catch(a){i=null}if(null===i){if(null===f)throw new Error("We can't skip over an invalid tag with undefined length at offset "+g);c.pos=g+Math.abs(f)}return new a(d,h,f,e,i)},a}(),R=function(){function a(a){var b=a.get();if(this.tagClass=b>>6,this.tagConstructed=0!=(32&b),this.tagNumber=31&b,31==this.tagNumber){var c=new L;do{b=a.get(),c.mulAdd(128,127&b)}while(128&b);this.tagNumber=c.simplify()}}return a.prototype.isUniversal=function(){return 0===this.tagClass},a.prototype.isEOC=function(){return 0===this.tagClass&&0===this.tagNumber},a}(),S=0xdeadbeefcafe,T=15715070==(16777215&S),U=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],V=(1<<26)/U[U.length-1],W=function(){function a(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}return a.prototype.toString=function(a){if(this.s<0)return"-"+this.negate().toString(a);var c;if(16==a)c=4;else if(8==a)c=3;else if(2==a)c=1;else if(32==a)c=5;else{if(4!=a)return this.toRadix(a);c=2}var d,e=(1<<c)-1,f=!1,g="",h=this.t,i=this.DB-h*this.DB%c;if(h-- >0)for(i<this.DB&&(d=this[h]>>i)>0&&(f=!0,g=b(d));h>=0;)i<c?(d=(this[h]&(1<<i)-1)<<c-i,d|=this[--h]>>(i+=this.DB-c)):(d=this[h]>>(i-=c)&e,i<=0&&(i+=this.DB,--h)),d>0&&(f=!0),f&&(g+=b(d));return f?g:"0"},a.prototype.negate=function(){var b=m();return a.ZERO.subTo(this,b),b},a.prototype.abs=function(){return this.s<0?this.negate():this},a.prototype.compareTo=function(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;if(0!=(b=c-a.t))return this.s<0?-b:b;for(;--c>=0;)if(0!=(b=this[c]-a[c]))return b;return 0},a.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+t(this[this.t-1]^this.s&this.DM)},a.prototype.mod=function(b){var c=m();return this.abs().divRemTo(b,null,c),this.s<0&&c.compareTo(a.ZERO)>0&&b.subTo(c,c),c},a.prototype.modPowInt=function(a,b){var c;return c=a<256||b.isEven()?new Y(b):new Z(b),this.exp(a,c)},a.prototype.clone=function(){var a=m();return this.copyTo(a),a},a.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},a.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},a.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},a.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},a.prototype.toByteArray=function(){var a=this.t,b=[];b[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(a-- >0)for(d<this.DB&&(c=this[a]>>d)!=(this.s&this.DM)>>d&&(b[e++]=c|this.s<<this.DB-d);a>=0;)d<8?(c=(this[a]&(1<<d)-1)<<8-d,c|=this[--a]>>(d+=this.DB-8)):(c=this[a]>>(d-=8)&255,d<=0&&(d+=this.DB,--a)),0!=(128&c)&&(c|=-256),0==e&&(128&this.s)!=(128&c)&&++e,(e>0||c!=this.s)&&(b[e++]=c);return b},a.prototype.equals=function(a){return 0==this.compareTo(a)},a.prototype.min=function(a){return this.compareTo(a)<0?this:a},a.prototype.max=function(a){return this.compareTo(a)>0?this:a},a.prototype.and=function(a){var b=m();return this.bitwiseTo(a,c,b),b},a.prototype.or=function(a){var b=m();return this.bitwiseTo(a,d,b),b},a.prototype.xor=function(a){var b=m();return this.bitwiseTo(a,e,b),b},a.prototype.andNot=function(a){var b=m();return this.bitwiseTo(a,f,b),b},a.prototype.not=function(){for(var a=m(),b=0;b<this.t;++b)a[b]=this.DM&~this[b];return a.t=this.t,a.s=~this.s,a},a.prototype.shiftLeft=function(a){var b=m();return a<0?this.rShiftTo(-a,b):this.lShiftTo(a,b),b},a.prototype.shiftRight=function(a){var b=m();return a<0?this.lShiftTo(-a,b):this.rShiftTo(a,b),b},a.prototype.getLowestSetBit=function(){for(var a=0;a<this.t;++a)if(0!=this[a])return a*this.DB+g(this[a]);return this.s<0?this.t*this.DB:-1},a.prototype.bitCount=function(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=h(this[c]^b);return a},a.prototype.testBit=function(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this[b]&1<<a%this.DB)},a.prototype.setBit=function(a){return this.changeBit(a,d)},a.prototype.clearBit=function(a){return this.changeBit(a,f)},a.prototype.flipBit=function(a){return this.changeBit(a,e)},a.prototype.add=function(a){var b=m();return this.addTo(a,b),b},a.prototype.subtract=function(a){var b=m();return this.subTo(a,b),b},a.prototype.multiply=function(a){var b=m();return this.multiplyTo(a,b),b},a.prototype.divide=function(a){var b=m();return this.divRemTo(a,b,null),b},a.prototype.remainder=function(a){var b=m();return this.divRemTo(a,null,b),b},a.prototype.divideAndRemainder=function(a){var b=m(),c=m();return this.divRemTo(a,b,c),[b,c]},a.prototype.modPow=function(a,b){var c,d,e=a.bitLength(),f=s(1);if(e<=0)return f;c=e<18?1:e<48?3:e<144?4:e<768?5:6,d=e<8?new Y(b):b.isEven()?new $(b):new Z(b);var g=[],h=3,i=c-1,j=(1<<c)-1;if(g[1]=d.convert(this),c>1){var k=m();for(d.sqrTo(g[1],k);h<=j;)g[h]=m(),d.mulTo(k,g[h-2],g[h]),h+=2}var l,n,o=a.t-1,p=!0,q=m();for(e=t(a[o])-1;o>=0;){for(e>=i?l=a[o]>>e-i&j:(l=(a[o]&(1<<e+1)-1)<<i-e,o>0&&(l|=a[o-1]>>this.DB+e-i)),h=c;0==(1&l);)l>>=1,--h;if((e-=h)<0&&(e+=this.DB,--o),p)g[l].copyTo(f),p=!1;else{for(;h>1;)d.sqrTo(f,q),d.sqrTo(q,f),h-=2;h>0?d.sqrTo(f,q):(n=f,f=q,q=n),d.mulTo(q,g[l],f)}for(;o>=0&&0==(a[o]&1<<e);)d.sqrTo(f,q),n=f,f=q,q=n,--e<0&&(e=this.DB-1,--o)}return d.revert(f)},a.prototype.modInverse=function(b){var c=b.isEven();if(this.isEven()&&c||0==b.signum())return a.ZERO;for(var d=b.clone(),e=this.clone(),f=s(1),g=s(0),h=s(0),i=s(1);0!=d.signum();){for(;d.isEven();)d.rShiftTo(1,d),c?(f.isEven()&&g.isEven()||(f.addTo(this,f),g.subTo(b,g)),f.rShiftTo(1,f)):g.isEven()||g.subTo(b,g),g.rShiftTo(1,g);for(;e.isEven();)e.rShiftTo(1,e),c?(h.isEven()&&i.isEven()||(h.addTo(this,h),i.subTo(b,i)),h.rShiftTo(1,h)):i.isEven()||i.subTo(b,i),i.rShiftTo(1,i);d.compareTo(e)>=0?(d.subTo(e,d),c&&f.subTo(h,f),g.subTo(i,g)):(e.subTo(d,e),c&&h.subTo(f,h),i.subTo(g,i))}return 0!=e.compareTo(a.ONE)?a.ZERO:i.compareTo(b)>=0?i.subtract(b):i.signum()<0?(i.addTo(b,i),i.signum()<0?i.add(b):i):i},a.prototype.pow=function(a){return this.exp(a,new X)},a.prototype.gcd=function(a){var b=this.s<0?this.negate():this.clone(),c=a.s<0?a.negate():a.clone();if(b.compareTo(c)<0){var d=b;b=c,c=d}var e=b.getLowestSetBit(),f=c.getLowestSetBit();if(f<0)return b;for(e<f&&(f=e),f>0&&(b.rShiftTo(f,b),c.rShiftTo(f,c));b.signum()>0;)(e=b.getLowestSetBit())>0&&b.rShiftTo(e,b),(e=c.getLowestSetBit())>0&&c.rShiftTo(e,c),b.compareTo(c)>=0?(b.subTo(c,b),b.rShiftTo(1,b)):(c.subTo(b,c),c.rShiftTo(1,c));return f>0&&c.lShiftTo(f,c),c},a.prototype.isProbablePrime=function(a){var b,c=this.abs();if(1==c.t&&c[0]<=U[U.length-1]){for(b=0;b<U.length;++b)if(c[0]==U[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<U.length;){for(var d=U[b],e=b+1;e<U.length&&d<V;)d*=U[e++];for(d=c.modInt(d);b<e;)if(d%U[b++]==0)return!1}return c.millerRabin(a)},a.prototype.copyTo=function(a){for(var b=this.t-1;b>=0;--b)a[b]=this[b];a.t=this.t,a.s=this.s},a.prototype.fromInt=function(a){this.t=1,this.s=a<0?-1:0,a>0?this[0]=a:a<-1?this[0]=a+this.DV:this.t=0},a.prototype.fromString=function(b,c){var d;if(16==c)d=4;else if(8==c)d=3;else if(256==c)d=8;else if(2==c)d=1;else if(32==c)d=5;else{if(4!=c)return void this.fromRadix(b,c);d=2}this.t=0,this.s=0;for(var e=b.length,f=!1,g=0;--e>=0;){var h=8==d?255&+b[e]:r(b,e);h<0?"-"==b.charAt(e)&&(f=!0):(f=!1,0==g?this[this.t++]=h:g+d>this.DB?(this[this.t-1]|=(h&(1<<this.DB-g)-1)<<g,this[this.t++]=h>>this.DB-g):this[this.t-1]|=h<<g,(g+=d)>=this.DB&&(g-=this.DB))}8==d&&0!=(128&+b[0])&&(this.s=-1,g>0&&(this[this.t-1]|=(1<<this.DB-g)-1<<g)),this.clamp(),f&&a.ZERO.subTo(this,this)},a.prototype.clamp=function(){for(var a=this.s&this.DM;this.t>0&&this[this.t-1]==a;)--this.t},a.prototype.dlShiftTo=function(a,b){var c;for(c=this.t-1;c>=0;--c)b[c+a]=this[c];for(c=a-1;c>=0;--c)b[c]=0;b.t=this.t+a,b.s=this.s},a.prototype.drShiftTo=function(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0),b.s=this.s},a.prototype.lShiftTo=function(a,b){for(var c=a%this.DB,d=this.DB-c,e=(1<<d)-1,f=Math.floor(a/this.DB),g=this.s<<c&this.DM,h=this.t-1;h>=0;--h)b[h+f+1]=this[h]>>d|g,g=(this[h]&e)<<c;for(var h=f-1;h>=0;--h)b[h]=0;b[f]=g,b.t=this.t+f+1,b.s=this.s,b.clamp()},a.prototype.rShiftTo=function(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)return void(b.t=0);var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;d>0&&(b[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()},a.prototype.subTo=function(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=d<0?-1:0,d<-1?b[c++]=this.DV+d:d>0&&(b[c++]=d),b.t=c,b.clamp()},a.prototype.multiplyTo=function(b,c){var d=this.abs(),e=b.abs(),f=d.t;for(c.t=f+e.t;--f>=0;)c[f]=0;for(f=0;f<e.t;++f)c[f+d.t]=d.am(0,e[f],c,f,0,d.t);c.s=0,c.clamp(),this.s!=b.s&&a.ZERO.subTo(c,c)},a.prototype.squareTo=function(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}a.t>0&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1)),a.s=0,a.clamp()},a.prototype.divRemTo=function(b,c,d){var e=b.abs();if(!(e.t<=0)){var f=this.abs();if(f.t<e.t)return null!=c&&c.fromInt(0),void(null!=d&&this.copyTo(d));null==d&&(d=m());var g=m(),h=this.s,i=b.s,j=this.DB-t(e[e.t-1]);j>0?(e.lShiftTo(j,g),f.lShiftTo(j,d)):(e.copyTo(g),f.copyTo(d));var k=g.t,l=g[k-1];if(0!=l){var n=l*(1<<this.F1)+(k>1?g[k-2]>>this.F2:0),o=this.FV/n,p=(1<<this.F1)/n,q=1<<this.F2,r=d.t,s=r-k,u=null==c?m():c;for(g.dlShiftTo(s,u),d.compareTo(u)>=0&&(d[d.t++]=1,d.subTo(u,d)),a.ONE.dlShiftTo(k,u),u.subTo(g,g);g.t<k;)g[g.t++]=0;for(;--s>=0;){var v=d[--r]==l?this.DM:Math.floor(d[r]*o+(d[r-1]+q)*p);if((d[r]+=g.am(0,v,d,s,0,k))<v)for(g.dlShiftTo(s,u),d.subTo(u,d);d[r]<--v;)d.subTo(u,d)}null!=c&&(d.drShiftTo(k,c),h!=i&&a.ZERO.subTo(c,c)),d.t=k,d.clamp(),j>0&&d.rShiftTo(j,d),h<0&&a.ZERO.subTo(d,d)}}},a.prototype.invDigit=function(){if(this.t<1)return 0;var a=this[0];if(0==(1&a))return 0;var b=3&a;return b=b*(2-(15&a)*b)&15,b=b*(2-(255&a)*b)&255,b=b*(2-((65535&a)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b},a.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},a.prototype.exp=function(b,c){if(b>4294967295||b<1)return a.ONE;var d=m(),e=m(),f=c.convert(this),g=t(b)-1;for(f.copyTo(d);--g>=0;)if(c.sqrTo(d,e),(b&1<<g)>0)c.mulTo(e,f,d);else{var h=d;d=e,e=h}return c.revert(d)},a.prototype.chunkSize=function(a){return Math.floor(Math.LN2*this.DB/Math.log(a))},a.prototype.toRadix=function(a){if(null==a&&(a=10),0==this.signum()||a<2||a>36)return"0";var b=this.chunkSize(a),c=Math.pow(a,b),d=s(c),e=m(),f=m(),g="";for(this.divRemTo(d,e,f);e.signum()>0;)g=(c+f.intValue()).toString(a).substr(1)+g,e.divRemTo(d,e,f);return f.intValue().toString(a)+g},a.prototype.fromRadix=function(b,c){this.fromInt(0),null==c&&(c=10);for(var d=this.chunkSize(c),e=Math.pow(c,d),f=!1,g=0,h=0,i=0;i<b.length;++i){var j=r(b,i);j<0?"-"==b.charAt(i)&&0==this.signum()&&(f=!0):(h=c*h+j,++g>=d&&(this.dMultiply(e),this.dAddOffset(h,0),g=0,h=0))}g>0&&(this.dMultiply(Math.pow(c,g)),this.dAddOffset(h,0)),f&&a.ZERO.subTo(this,this)},a.prototype.fromNumber=function(b,c,e){if("number"==typeof c)if(b<2)this.fromInt(1);else for(this.fromNumber(b,e),this.testBit(b-1)||this.bitwiseTo(a.ONE.shiftLeft(b-1),d,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(c);)this.dAddOffset(2,0),this.bitLength()>b&&this.subTo(a.ONE.shiftLeft(b-1),this);else{var f=[],g=7&b;f.length=1+(b>>3),c.nextBytes(f),g>0?f[0]&=(1<<g)-1:f[0]=0,this.fromString(f,256)}},a.prototype.bitwiseTo=function(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;d<f;++d)c[d]=b(this[d],a[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c[d]=b(this[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c[d]=b(e,a[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()},a.prototype.changeBit=function(b,c){var d=a.ONE.shiftLeft(b);return this.bitwiseTo(d,c,d),d},a.prototype.addTo=function(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this[c]+a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a[c],b[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=d<0?-1:0,d>0?b[c++]=d:d<-1&&(b[c++]=this.DV+d),b.t=c,b.clamp()},a.prototype.dMultiply=function(a){this[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()},a.prototype.dAddOffset=function(a,b){if(0!=a){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}},a.prototype.multiplyLowerTo=function(a,b,c){var d=Math.min(this.t+a.t,b);for(c.s=0,c.t=d;d>0;)c[--d]=0;for(var e=c.t-this.t;d<e;++d)c[d+this.t]=this.am(0,a[d],c,d,0,this.t);for(var e=Math.min(a.t,b);d<e;++d)this.am(0,a[d],c,d,0,b-d);c.clamp()},a.prototype.multiplyUpperTo=function(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;--d>=0;)c[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c[this.t+d-b]=this.am(b-d,a[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)},a.prototype.modInt=function(a){if(a<=0)return 0;var b=this.DV%a,c=this.s<0?a-1:0;if(this.t>0)if(0==b)c=this[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this[d])%a;return c},a.prototype.millerRabin=function(b){var c=this.subtract(a.ONE),d=c.getLowestSetBit();if(d<=0)return!1;var e=c.shiftRight(d);(b=b+1>>1)>U.length&&(b=U.length);for(var f=m(),g=0;g<b;++g){f.fromInt(U[Math.floor(Math.random()*U.length)]);var h=f.modPow(e,this);if(0!=h.compareTo(a.ONE)&&0!=h.compareTo(c)){for(var i=1;i++<d&&0!=h.compareTo(c);)if(h=h.modPowInt(2,this),0==h.compareTo(a.ONE))return!1;if(0!=h.compareTo(c))return!1}}return!0},a.prototype.square=function(){var a=m();return this.squareTo(a),a},a.prototype.gcda=function(a,b){var c=this.s<0?this.negate():this.clone(),d=a.s<0?a.negate():a.clone();if(c.compareTo(d)<0){var e=c;c=d,d=e}var f=c.getLowestSetBit(),g=d.getLowestSetBit();if(g<0)return void b(c);f<g&&(g=f),g>0&&(c.rShiftTo(g,c),d.rShiftTo(g,d));var h=function(){(f=c.getLowestSetBit())>0&&c.rShiftTo(f,c),(f=d.getLowestSetBit())>0&&d.rShiftTo(f,d),c.compareTo(d)>=0?(c.subTo(d,c),c.rShiftTo(1,c)):(d.subTo(c,d),d.rShiftTo(1,d)),c.signum()>0?setTimeout(h,0):(g>0&&d.lShiftTo(g,d),setTimeout(function(){b(d)},0))};setTimeout(h,10)},a.prototype.fromNumberAsync=function(b,c,e,f){if("number"==typeof c)if(b<2)this.fromInt(1);else{this.fromNumber(b,e),this.testBit(b-1)||this.bitwiseTo(a.ONE.shiftLeft(b-1),d,this),this.isEven()&&this.dAddOffset(1,0);var g=this,h=function(){g.dAddOffset(2,0),g.bitLength()>b&&g.subTo(a.ONE.shiftLeft(b-1),g),g.isProbablePrime(c)?setTimeout(function(){f()},0):setTimeout(h,0)};setTimeout(h,0)}else{var i=[],j=7&b;i.length=1+(b>>3),c.nextBytes(i),j>0?i[0]&=(1<<j)-1:i[0]=0,this.fromString(i,256)}},a}(),X=function(){function a(){}return a.prototype.convert=function(a){return a},a.prototype.revert=function(a){return a},a.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c)},a.prototype.sqrTo=function(a,b){a.squareTo(b)},a}(),Y=function(){function a(a){this.m=a}return a.prototype.convert=function(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a},a.prototype.revert=function(a){return a},a.prototype.reduce=function(a){a.divRemTo(this.m,null,a)},a.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c),this.reduce(c)},a.prototype.sqrTo=function(a,b){a.squareTo(b),this.reduce(b)},a}(),Z=function(){function a(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}return a.prototype.convert=function(a){var b=m();return a.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),a.s<0&&b.compareTo(W.ZERO)>0&&this.m.subTo(b,b),b},a.prototype.revert=function(a){var b=m();return a.copyTo(b),this.reduce(b),b},a.prototype.reduce=function(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a[b],d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(c=b+this.m.t,a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)},a.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c),this.reduce(c)},a.prototype.sqrTo=function(a,b){a.squareTo(b),this.reduce(b)},a}(),$=function(){function a(a){this.m=a,this.r2=m(),this.q3=m(),W.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a)}return a.prototype.convert=function(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var b=m();return a.copyTo(b),this.reduce(b),b},a.prototype.revert=function(a){return a},a.prototype.reduce=function(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)},a.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c),this.reduce(c)},a.prototype.sqrTo=function(a,b){a.squareTo(b),this.reduce(b)},a}();T&&"Microsoft Internet Explorer"==navigator.appName?(W.prototype.am=p,D=30):T&&"Netscape"!=navigator.appName?(W.prototype.am=o,D=26):(W.prototype.am=q,D=28),W.prototype.DB=D,W.prototype.DM=(1<<D)-1,W.prototype.DV=1<<D;var _=52;W.prototype.FV=Math.pow(2,_),W.prototype.F1=_-D,W.prototype.F2=2*D-_;var aa,ba,ca=[];for(aa="0".charCodeAt(0),ba=0;ba<=9;++ba)ca[aa++]=ba;for(aa="a".charCodeAt(0),ba=10;ba<36;++ba)ca[aa++]=ba;for(aa="A".charCodeAt(0),ba=10;ba<36;++ba)ca[aa++]=ba;W.ZERO=s(0),W.ONE=s(1);var da,ea,fa=function(){function a(){this.i=0,this.j=0,this.S=[]}return a.prototype.init=function(a){var b,c,d;for(b=0;b<256;++b)this.S[b]=b;for(c=0,b=0;b<256;++b)c=c+this.S[b]+a[b%a.length]&255,d=this.S[b],this.S[b]=this.S[c],this.S[c]=d;this.i=0,this.j=0},a.prototype.next=function(){var a;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,a=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=a,this.S[a+this.S[this.i]&255]},a}(),ga=256,ha=null;if(null==ha){ha=[],ea=0;var ia=void 0;if(window.crypto&&window.crypto.getRandomValues){var ja=new Uint32Array(256);for(window.crypto.getRandomValues(ja),ia=0;ia<ja.length;++ia)ha[ea++]=255&ja[ia]}var ka=function(a){if(this.count=this.count||0,
this.count>=256||ea>=ga)return void(window.removeEventListener?window.removeEventListener("mousemove",ka,!1):window.detachEvent&&window.detachEvent("onmousemove",ka));try{var b=a.x+a.y;ha[ea++]=255&b,this.count+=1}catch(a){}};window.addEventListener?window.addEventListener("mousemove",ka,!1):window.attachEvent&&window.attachEvent("onmousemove",ka)}var la=function(){function a(){}return a.prototype.nextBytes=function(a){for(var b=0;b<a.length;++b)a[b]=v()},a}(),ma=function(){function a(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return a.prototype.doPublic=function(a){return a.modPowInt(this.e,this.n)},a.prototype.doPrivate=function(a){if(null==this.p||null==this.q)return a.modPow(this.d,this.n);for(var b=a.mod(this.p).modPow(this.dmp1,this.p),c=a.mod(this.q).modPow(this.dmq1,this.q);b.compareTo(c)<0;)b=b.add(this.p);return b.subtract(c).multiply(this.coeff).mod(this.p).multiply(this.q).add(c)},a.prototype.setPublic=function(a,b){null!=a&&null!=b&&a.length>0&&b.length>0?(this.n=n(a,16),this.e=parseInt(b,16)):console.error("Invalid RSA public key")},a.prototype.encrypt=function(a){var b=x(a,this.n.bitLength()+7>>3);if(null==b)return null;var c=this.doPublic(b);if(null==c)return null;var d=c.toString(16);return 0==(1&d.length)?d:"0"+d},a.prototype.setPrivate=function(a,b,c){null!=a&&null!=b&&a.length>0&&b.length>0?(this.n=n(a,16),this.e=parseInt(b,16),this.d=n(c,16)):console.error("Invalid RSA private key")},a.prototype.setPrivateEx=function(a,b,c,d,e,f,g,h){null!=a&&null!=b&&a.length>0&&b.length>0?(this.n=n(a,16),this.e=parseInt(b,16),this.d=n(c,16),this.p=n(d,16),this.q=n(e,16),this.dmp1=n(f,16),this.dmq1=n(g,16),this.coeff=n(h,16)):console.error("Invalid RSA private key")},a.prototype.generate=function(a,b){var c=new la,d=a>>1;this.e=parseInt(b,16);for(var e=new W(b,16);;){for(;this.p=new W(a-d,1,c),0!=this.p.subtract(W.ONE).gcd(e).compareTo(W.ONE)||!this.p.isProbablePrime(10););for(;this.q=new W(d,1,c),0!=this.q.subtract(W.ONE).gcd(e).compareTo(W.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var f=this.p;this.p=this.q,this.q=f}var g=this.p.subtract(W.ONE),h=this.q.subtract(W.ONE),i=g.multiply(h);if(0==i.gcd(e).compareTo(W.ONE)){this.n=this.p.multiply(this.q),this.d=e.modInverse(i),this.dmp1=this.d.mod(g),this.dmq1=this.d.mod(h),this.coeff=this.q.modInverse(this.p);break}}},a.prototype.decrypt=function(a){var b=n(a,16),c=this.doPrivate(b);return null==c?null:y(c,this.n.bitLength()+7>>3)},a.prototype.generateAsync=function(a,b,c){var d=new la,e=a>>1;this.e=parseInt(b,16);var f=new W(b,16),g=this,h=function(){var b=function(){if(g.p.compareTo(g.q)<=0){var a=g.p;g.p=g.q,g.q=a}var b=g.p.subtract(W.ONE),d=g.q.subtract(W.ONE),e=b.multiply(d);0==e.gcd(f).compareTo(W.ONE)?(g.n=g.p.multiply(g.q),g.d=f.modInverse(e),g.dmp1=g.d.mod(b),g.dmq1=g.d.mod(d),g.coeff=g.q.modInverse(g.p),setTimeout(function(){c()},0)):setTimeout(h,0)},i=function(){g.q=m(),g.q.fromNumberAsync(e,1,d,function(){g.q.subtract(W.ONE).gcda(f,function(a){0==a.compareTo(W.ONE)&&g.q.isProbablePrime(10)?setTimeout(b,0):setTimeout(i,0)})})},j=function(){g.p=m(),g.p.fromNumberAsync(a-e,1,d,function(){g.p.subtract(W.ONE).gcda(f,function(a){0==a.compareTo(W.ONE)&&g.p.isProbablePrime(10)?setTimeout(i,0):setTimeout(j,0)})})};setTimeout(j,0)};setTimeout(h,0)},a.prototype.sign=function(a,b,c){var d=z(c),e=d+b(a).toString(),f=w(e,this.n.bitLength()/4);if(null==f)return null;var g=this.doPrivate(f);if(null==g)return null;var h=g.toString(16);return 0==(1&h.length)?h:"0"+h},a.prototype.verify=function(a,b,c){var d=n(b,16),e=this.doPublic(d);return null==e?null:A(e.toString(16).replace(/^1f+00/,""))==c(a).toString()},a}(),na={md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",ripemd160:"3021300906052b2403020105000414"},oa={};oa.lang={extend:function(a,b,c){if(!b||!a)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var d=function(){};if(d.prototype=b.prototype,a.prototype=new d,a.prototype.constructor=a,a.superclass=b.prototype,b.prototype.constructor==Object.prototype.constructor&&(b.prototype.constructor=b),c){var e;for(e in c)a.prototype[e]=c[e];var f=function(){},g=["toString","valueOf"];try{/MSIE/.test(navigator.userAgent)&&(f=function(a,b){for(e=0;e<g.length;e+=1){var c=g[e],d=b[c];"function"==typeof d&&d!=Object.prototype[c]&&(a[c]=d)}})}catch(a){}f(a.prototype,c)}}};var pa={};void 0!==pa.asn1&&pa.asn1||(pa.asn1={}),pa.asn1.ASN1Util=new function(){this.integerToByteHex=function(a){var b=a.toString(16);return b.length%2==1&&(b="0"+b),b},this.bigIntToMinTwosComplementsHex=function(a){var b=a.toString(16);if("-"!=b.substr(0,1))b.length%2==1?b="0"+b:b.match(/^[0-7]/)||(b="00"+b);else{var c=b.substr(1),d=c.length;d%2==1?d+=1:b.match(/^[0-7]/)||(d+=2);for(var e="",f=0;f<d;f++)e+="f";b=new W(e,16).xor(a).add(W.ONE).toString(16).replace(/^-/,"")}return b},this.getPEMStringFromHex=function(a,b){return hextopem(a,b)},this.newObject=function(a){var b=pa,c=b.asn1,d=c.DERBoolean,e=c.DERInteger,f=c.DERBitString,g=c.DEROctetString,h=c.DERNull,i=c.DERObjectIdentifier,j=c.DEREnumerated,k=c.DERUTF8String,l=c.DERNumericString,m=c.DERPrintableString,n=c.DERTeletexString,o=c.DERIA5String,p=c.DERUTCTime,q=c.DERGeneralizedTime,r=c.DERSequence,s=c.DERSet,t=c.DERTaggedObject,u=c.ASN1Util.newObject,v=Object.keys(a);if(1!=v.length)throw"key of param shall be only one.";var w=v[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+w+":"))throw"undefined key: "+w;if("bool"==w)return new d(a[w]);if("int"==w)return new e(a[w]);if("bitstr"==w)return new f(a[w]);if("octstr"==w)return new g(a[w]);if("null"==w)return new h(a[w]);if("oid"==w)return new i(a[w]);if("enum"==w)return new j(a[w]);if("utf8str"==w)return new k(a[w]);if("numstr"==w)return new l(a[w]);if("prnstr"==w)return new m(a[w]);if("telstr"==w)return new n(a[w]);if("ia5str"==w)return new o(a[w]);if("utctime"==w)return new p(a[w]);if("gentime"==w)return new q(a[w]);if("seq"==w){for(var x=a[w],y=[],z=0;z<x.length;z++){var A=u(x[z]);y.push(A)}return new r({array:y})}if("set"==w){for(var x=a[w],y=[],z=0;z<x.length;z++){var A=u(x[z]);y.push(A)}return new s({array:y})}if("tag"==w){var B=a[w];if("[object Array]"===Object.prototype.toString.call(B)&&3==B.length){var C=u(B[2]);return new t({tag:B[0],explicit:B[1],obj:C})}var D={};if(void 0!==B.explicit&&(D.explicit=B.explicit),void 0!==B.tag&&(D.tag=B.tag),void 0===B.obj)throw"obj shall be specified for 'tag'.";return D.obj=u(B.obj),new t(D)}},this.jsonToASN1HEX=function(a){return this.newObject(a).getEncodedHex()}},pa.asn1.ASN1Util.oidHexToInt=function(a){for(var b="",c=parseInt(a.substr(0,2),16),d=Math.floor(c/40),e=c%40,b=d+"."+e,f="",g=2;g<a.length;g+=2){var h=parseInt(a.substr(g,2),16),i=("00000000"+h.toString(2)).slice(-8);if(f+=i.substr(1,7),"0"==i.substr(0,1)){b=b+"."+new W(f,2).toString(10),f=""}}return b},pa.asn1.ASN1Util.oidIntToHex=function(a){var b=function(a){var b=a.toString(16);return 1==b.length&&(b="0"+b),b},c=function(a){var c="",d=new W(a,10),e=d.toString(2),f=7-e.length%7;7==f&&(f=0);for(var g="",h=0;h<f;h++)g+="0";e=g+e;for(var h=0;h<e.length-1;h+=7){var i=e.substr(h,7);h!=e.length-7&&(i="1"+i),c+=b(parseInt(i,2))}return c};if(!a.match(/^[0-9.]+$/))throw"malformed oid string: "+a;var d="",e=a.split("."),f=40*parseInt(e[0])+parseInt(e[1]);d+=b(f),e.splice(0,2);for(var g=0;g<e.length;g++)d+=c(e[g]);return d},pa.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+"".length+",v="+this.hV;var a=this.hV.length/2,b=a.toString(16);if(b.length%2==1&&(b="0"+b),a<128)return b;var c=b.length/2;if(c>15)throw"ASN.1 length too long to represent by 8x: n = "+a.toString(16);return(128+c).toString(16)+b},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},pa.asn1.DERAbstractString=function(a){pa.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(a){this.hTLV=null,this.isModified=!0,this.s=a,this.hV=stohex(this.s)},this.setStringHex=function(a){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=a},this.getFreshValueHex=function(){return this.hV},void 0!==a&&("string"==typeof a?this.setString(a):void 0!==a.str?this.setString(a.str):void 0!==a.hex&&this.setStringHex(a.hex))},oa.lang.extend(pa.asn1.DERAbstractString,pa.asn1.ASN1Object),pa.asn1.DERAbstractTime=function(a){pa.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(a){return utc=a.getTime()+6e4*a.getTimezoneOffset(),new Date(utc)},this.formatDate=function(a,b,c){var d=this.zeroPadding,e=this.localDateToUTC(a),f=String(e.getFullYear());"utc"==b&&(f=f.substr(2,2));var g=d(String(e.getMonth()+1),2),h=d(String(e.getDate()),2),i=d(String(e.getHours()),2),j=d(String(e.getMinutes()),2),k=d(String(e.getSeconds()),2),l=f+g+h+i+j+k;if(!0===c){var m=e.getMilliseconds();if(0!=m){var n=d(String(m),3);n=n.replace(/[0]+$/,""),l=l+"."+n}}return l+"Z"},this.zeroPadding=function(a,b){return a.length>=b?a:new Array(b-a.length+1).join("0")+a},this.getString=function(){return this.s},this.setString=function(a){this.hTLV=null,this.isModified=!0,this.s=a,this.hV=stohex(a)},this.setByDateValue=function(a,b,c,d,e,f){var g=new Date(Date.UTC(a,b-1,c,d,e,f,0));this.setByDate(g)},this.getFreshValueHex=function(){return this.hV}},oa.lang.extend(pa.asn1.DERAbstractTime,pa.asn1.ASN1Object),pa.asn1.DERAbstractStructured=function(a){pa.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(a){this.hTLV=null,this.isModified=!0,this.asn1Array=a},this.appendASN1Object=function(a){this.hTLV=null,this.isModified=!0,this.asn1Array.push(a)},this.asn1Array=new Array,void 0!==a&&void 0!==a.array&&(this.asn1Array=a.array)},oa.lang.extend(pa.asn1.DERAbstractStructured,pa.asn1.ASN1Object),pa.asn1.DERBoolean=function(){pa.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},oa.lang.extend(pa.asn1.DERBoolean,pa.asn1.ASN1Object),pa.asn1.DERInteger=function(a){pa.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(a){this.hTLV=null,this.isModified=!0,this.hV=pa.asn1.ASN1Util.bigIntToMinTwosComplementsHex(a)},this.setByInteger=function(a){var b=new W(String(a),10);this.setByBigInteger(b)},this.setValueHex=function(a){this.hV=a},this.getFreshValueHex=function(){return this.hV},void 0!==a&&(void 0!==a.bigint?this.setByBigInteger(a.bigint):void 0!==a.int?this.setByInteger(a.int):"number"==typeof a?this.setByInteger(a):void 0!==a.hex&&this.setValueHex(a.hex))},oa.lang.extend(pa.asn1.DERInteger,pa.asn1.ASN1Object),pa.asn1.DERBitString=function(a){if(void 0!==a&&void 0!==a.obj){var b=pa.asn1.ASN1Util.newObject(a.obj);a.hex="00"+b.getEncodedHex()}pa.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(a){this.hTLV=null,this.isModified=!0,this.hV=a},this.setUnusedBitsAndHexValue=function(a,b){if(a<0||7<a)throw"unused bits shall be from 0 to 7: u = "+a;var c="0"+a;this.hTLV=null,this.isModified=!0,this.hV=c+b},this.setByBinaryString=function(a){a=a.replace(/0+$/,"");var b=8-a.length%8;8==b&&(b=0);for(var c=0;c<=b;c++)a+="0";for(var d="",c=0;c<a.length-1;c+=8){var e=a.substr(c,8),f=parseInt(e,2).toString(16);1==f.length&&(f="0"+f),d+=f}this.hTLV=null,this.isModified=!0,this.hV="0"+b+d},this.setByBooleanArray=function(a){for(var b="",c=0;c<a.length;c++)1==a[c]?b+="1":b+="0";this.setByBinaryString(b)},this.newFalseArray=function(a){for(var b=new Array(a),c=0;c<a;c++)b[c]=!1;return b},this.getFreshValueHex=function(){return this.hV},void 0!==a&&("string"==typeof a&&a.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(a):void 0!==a.hex?this.setHexValueIncludingUnusedBits(a.hex):void 0!==a.bin?this.setByBinaryString(a.bin):void 0!==a.array&&this.setByBooleanArray(a.array))},oa.lang.extend(pa.asn1.DERBitString,pa.asn1.ASN1Object),pa.asn1.DEROctetString=function(a){if(void 0!==a&&void 0!==a.obj){var b=pa.asn1.ASN1Util.newObject(a.obj);a.hex=b.getEncodedHex()}pa.asn1.DEROctetString.superclass.constructor.call(this,a),this.hT="04"},oa.lang.extend(pa.asn1.DEROctetString,pa.asn1.DERAbstractString),pa.asn1.DERNull=function(){pa.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},oa.lang.extend(pa.asn1.DERNull,pa.asn1.ASN1Object),pa.asn1.DERObjectIdentifier=function(a){var b=function(a){var b=a.toString(16);return 1==b.length&&(b="0"+b),b},c=function(a){var c="",d=new W(a,10),e=d.toString(2),f=7-e.length%7;7==f&&(f=0);for(var g="",h=0;h<f;h++)g+="0";e=g+e;for(var h=0;h<e.length-1;h+=7){var i=e.substr(h,7);h!=e.length-7&&(i="1"+i),c+=b(parseInt(i,2))}return c};pa.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(a){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=a},this.setValueOidString=function(a){if(!a.match(/^[0-9.]+$/))throw"malformed oid string: "+a;var d="",e=a.split("."),f=40*parseInt(e[0])+parseInt(e[1]);d+=b(f),e.splice(0,2);for(var g=0;g<e.length;g++)d+=c(e[g]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=d},this.setValueName=function(a){var b=pa.asn1.x509.OID.name2oid(a);if(""===b)throw"DERObjectIdentifier oidName undefined: "+a;this.setValueOidString(b)},this.getFreshValueHex=function(){return this.hV},void 0!==a&&("string"==typeof a?a.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(a):this.setValueName(a):void 0!==a.oid?this.setValueOidString(a.oid):void 0!==a.hex?this.setValueHex(a.hex):void 0!==a.name&&this.setValueName(a.name))},oa.lang.extend(pa.asn1.DERObjectIdentifier,pa.asn1.ASN1Object),pa.asn1.DEREnumerated=function(a){pa.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(a){this.hTLV=null,this.isModified=!0,this.hV=pa.asn1.ASN1Util.bigIntToMinTwosComplementsHex(a)},this.setByInteger=function(a){var b=new W(String(a),10);this.setByBigInteger(b)},this.setValueHex=function(a){this.hV=a},this.getFreshValueHex=function(){return this.hV},void 0!==a&&(void 0!==a.int?this.setByInteger(a.int):"number"==typeof a?this.setByInteger(a):void 0!==a.hex&&this.setValueHex(a.hex))},oa.lang.extend(pa.asn1.DEREnumerated,pa.asn1.ASN1Object),pa.asn1.DERUTF8String=function(a){pa.asn1.DERUTF8String.superclass.constructor.call(this,a),this.hT="0c"},oa.lang.extend(pa.asn1.DERUTF8String,pa.asn1.DERAbstractString),pa.asn1.DERNumericString=function(a){pa.asn1.DERNumericString.superclass.constructor.call(this,a),this.hT="12"},oa.lang.extend(pa.asn1.DERNumericString,pa.asn1.DERAbstractString),pa.asn1.DERPrintableString=function(a){pa.asn1.DERPrintableString.superclass.constructor.call(this,a),this.hT="13"},oa.lang.extend(pa.asn1.DERPrintableString,pa.asn1.DERAbstractString),pa.asn1.DERTeletexString=function(a){pa.asn1.DERTeletexString.superclass.constructor.call(this,a),this.hT="14"},oa.lang.extend(pa.asn1.DERTeletexString,pa.asn1.DERAbstractString),pa.asn1.DERIA5String=function(a){pa.asn1.DERIA5String.superclass.constructor.call(this,a),this.hT="16"},oa.lang.extend(pa.asn1.DERIA5String,pa.asn1.DERAbstractString),pa.asn1.DERUTCTime=function(a){pa.asn1.DERUTCTime.superclass.constructor.call(this,a),this.hT="17",this.setByDate=function(a){this.hTLV=null,this.isModified=!0,this.date=a,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)),this.hV},void 0!==a&&(void 0!==a.str?this.setString(a.str):"string"==typeof a&&a.match(/^[0-9]{12}Z$/)?this.setString(a):void 0!==a.hex?this.setStringHex(a.hex):void 0!==a.date&&this.setByDate(a.date))},oa.lang.extend(pa.asn1.DERUTCTime,pa.asn1.DERAbstractTime),pa.asn1.DERGeneralizedTime=function(a){pa.asn1.DERGeneralizedTime.superclass.constructor.call(this,a),this.hT="18",this.withMillis=!1,this.setByDate=function(a){this.hTLV=null,this.isModified=!0,this.date=a,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)),this.hV},void 0!==a&&(void 0!==a.str?this.setString(a.str):"string"==typeof a&&a.match(/^[0-9]{14}Z$/)?this.setString(a):void 0!==a.hex?this.setStringHex(a.hex):void 0!==a.date&&this.setByDate(a.date),!0===a.millis&&(this.withMillis=!0))},oa.lang.extend(pa.asn1.DERGeneralizedTime,pa.asn1.DERAbstractTime),pa.asn1.DERSequence=function(a){pa.asn1.DERSequence.superclass.constructor.call(this,a),this.hT="30",this.getFreshValueHex=function(){for(var a="",b=0;b<this.asn1Array.length;b++){a+=this.asn1Array[b].getEncodedHex()}return this.hV=a,this.hV}},oa.lang.extend(pa.asn1.DERSequence,pa.asn1.DERAbstractStructured),pa.asn1.DERSet=function(a){pa.asn1.DERSet.superclass.constructor.call(this,a),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var a=new Array,b=0;b<this.asn1Array.length;b++){var c=this.asn1Array[b];a.push(c.getEncodedHex())}return 1==this.sortFlag&&a.sort(),this.hV=a.join(""),this.hV},void 0!==a&&void 0!==a.sortflag&&0==a.sortflag&&(this.sortFlag=!1)},oa.lang.extend(pa.asn1.DERSet,pa.asn1.DERAbstractStructured),pa.asn1.DERTaggedObject=function(a){pa.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(a,b,c){this.hT=b,this.isExplicit=a,this.asn1Object=c,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=c.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,b),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==a&&(void 0!==a.tag&&(this.hT=a.tag),void 0!==a.explicit&&(this.isExplicit=a.explicit),void 0!==a.obj&&(this.asn1Object=a.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},oa.lang.extend(pa.asn1.DERTaggedObject,pa.asn1.ASN1Object);var qa=function(a){function b(c){var d=a.call(this)||this;return c&&("string"==typeof c?d.parseKey(c):(b.hasPrivateKeyProperty(c)||b.hasPublicKeyProperty(c))&&d.parsePropertiesFrom(c)),d}return k(b,a),b.prototype.parseKey=function(a){try{var b=0,c=0,d=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/,e=d.test(a)?I.decode(a):J.unarmor(a),f=Q.decode(e);if(3===f.sub.length&&(f=f.sub[2].sub[0]),9===f.sub.length){b=f.sub[1].getHexStringValue(),this.n=n(b,16),c=f.sub[2].getHexStringValue(),this.e=parseInt(c,16);var g=f.sub[3].getHexStringValue();this.d=n(g,16);var h=f.sub[4].getHexStringValue();this.p=n(h,16);var i=f.sub[5].getHexStringValue();this.q=n(i,16);var j=f.sub[6].getHexStringValue();this.dmp1=n(j,16);var k=f.sub[7].getHexStringValue();this.dmq1=n(k,16);var l=f.sub[8].getHexStringValue();this.coeff=n(l,16)}else{if(2!==f.sub.length)return!1;var m=f.sub[1],o=m.sub[0];b=o.sub[0].getHexStringValue(),this.n=n(b,16),c=o.sub[1].getHexStringValue(),this.e=parseInt(c,16)}return!0}catch(a){return!1}},b.prototype.getPrivateBaseKey=function(){var a={array:[new pa.asn1.DERInteger({int:0}),new pa.asn1.DERInteger({bigint:this.n}),new pa.asn1.DERInteger({int:this.e}),new pa.asn1.DERInteger({bigint:this.d}),new pa.asn1.DERInteger({bigint:this.p}),new pa.asn1.DERInteger({bigint:this.q}),new pa.asn1.DERInteger({bigint:this.dmp1}),new pa.asn1.DERInteger({bigint:this.dmq1}),new pa.asn1.DERInteger({bigint:this.coeff})]};return new pa.asn1.DERSequence(a).getEncodedHex()},b.prototype.getPrivateBaseKeyB64=function(){return i(this.getPrivateBaseKey())},b.prototype.getPublicBaseKey=function(){var a=new pa.asn1.DERSequence({array:[new pa.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new pa.asn1.DERNull]}),b=new pa.asn1.DERSequence({array:[new pa.asn1.DERInteger({bigint:this.n}),new pa.asn1.DERInteger({int:this.e})]}),c=new pa.asn1.DERBitString({hex:"00"+b.getEncodedHex()});return new pa.asn1.DERSequence({array:[a,c]}).getEncodedHex()},b.prototype.getPublicBaseKeyB64=function(){return i(this.getPublicBaseKey())},b.wordwrap=function(a,b){if(b=b||64,!a)return a;var c="(.{1,"+b+"})( +|$\n?)|(.{1,"+b+"})";return a.match(RegExp(c,"g")).join("\n")},b.prototype.getPrivateKey=function(){var a="-----BEGIN RSA PRIVATE KEY-----\n";return a+=b.wordwrap(this.getPrivateBaseKeyB64())+"\n",a+="-----END RSA PRIVATE KEY-----"},b.prototype.getPublicKey=function(){var a="-----BEGIN PUBLIC KEY-----\n";return a+=b.wordwrap(this.getPublicBaseKeyB64())+"\n",a+="-----END PUBLIC KEY-----"},b.hasPublicKeyProperty=function(a){return a=a||{},a.hasOwnProperty("n")&&a.hasOwnProperty("e")},b.hasPrivateKeyProperty=function(a){return a=a||{},a.hasOwnProperty("n")&&a.hasOwnProperty("e")&&a.hasOwnProperty("d")&&a.hasOwnProperty("p")&&a.hasOwnProperty("q")&&a.hasOwnProperty("dmp1")&&a.hasOwnProperty("dmq1")&&a.hasOwnProperty("coeff")},b.prototype.parsePropertiesFrom=function(a){this.n=a.n,this.e=a.e,a.hasOwnProperty("d")&&(this.d=a.d,this.p=a.p,this.q=a.q,this.dmp1=a.dmp1,this.dmq1=a.dmq1,this.coeff=a.coeff)},b}(ma),ra=function(){function a(a){a=a||{},this.default_key_size=parseInt(a.default_key_size,10)||1024,this.default_public_exponent=a.default_public_exponent||"010001",this.log=a.log||!1,this.key=null}return a.prototype.setKey=function(a){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new qa(a)},a.prototype.setPrivateKey=function(a){this.setKey(a)},a.prototype.setPublicKey=function(a){this.setKey(a)},a.prototype.decrypt=function(a){try{return this.getKey().decrypt(j(a))}catch(a){return!1}},a.prototype.encrypt=function(a){try{return i(this.getKey().encrypt(a))}catch(a){return!1}},a.prototype.sign=function(a,b,c){try{return i(this.getKey().sign(a,b,c))}catch(a){return!1}},a.prototype.verify=function(a,b,c){try{return this.getKey().verify(a,j(b),c)}catch(a){return!1}},a.prototype.getKey=function(a){if(!this.key){if(this.key=new qa,a&&"[object Function]"==={}.toString.call(a))return void this.key.generateAsync(this.default_key_size,this.default_public_exponent,a);this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},a.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},a.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},a.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},a.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},a.version="3.0.0-rc.1",a}();window.JSEncrypt=ra,a.JSEncrypt=ra,a.default=ra,Object.defineProperty(a,"__esModule",{value:!0})});